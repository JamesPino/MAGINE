<!DOCTYPE html>
<html>
<head>
    <meta charset=utf-8/>
    <style type="text/css">
        body {font: 14px helvetica neue, helvetica, arial, sans-serif;}

        #{{uuid}}{
            height: {{widget_height}}px;
            width: 90%;
            border: 5px solid black;
            box-sizing: border-box;
            position: absolute;
            top: 5px;
            background: {{background}};
        }
    </style>

    <script>
        (function () {
            function render() {
                $('#{{uuid}}').cytoscape({
                    elements: {
                        nodes: {{nodes}},
                        edges: {{edges}}
                    },

                    layout: {
                        name: '{{layout}}'
                    },

                    boxSelectionEnabled: true,
                    wheelSensitivity:.25,
                    ready: function () {
                        window.cy = this;
                        cy.fit();
                        cy.style().fromJson({{style_json}}).update();
                    }
                });
            }

            var before_render = function () {
                if (window['cytoscape'] === undefined) {
                    console.log("Waiting for Cyjs...");
                    window.addEventListener("load_cytoscape", before_render);
                } else {
                    console.log("Ready to render graph!");
                    render();
                }
            };
            before_render();
        })();
        if (window['cytoscape'] === undefined) {
    console.log('starting loading');

    requirejs.config({

        paths: {
            'cytoscape': 'https://cdnjs.cloudflare.com/ajax/libs/cytoscape/2.7.23/cytoscape.min',
            'cytoscape-qtip': 'https://cdn.rawgit.com/cytoscape/cytoscape.js-qtip/2.7.0/cytoscape-qtip',
            'jquery': 'https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min',
            'qtip2': 'https://cdnjs.cloudflare.com/ajax/libs/qtip2/2.2.0/basic/jquery.qtip.min',
            'cytoscape-cose-bilkent': 'https://cdn.rawgit.com/cytoscape/cytoscape.js-cose-bilkent/1.6.1/cytoscape-cose-bilkent'
        }
    });
    window.$ = window.jQuery = require('jquery');

    require(['cytoscape', 'cytoscape-qtip', 'jquery', 'cytoscape-cose-bilkent'],
        function (cytoscape, cyqtip, jquery, regCose) {
            console.log('Loading Cytoscape.js Module...');
            cyqtip(cytoscape, jquery);
            regCose(cytoscape);
            window['cytoscape'] = cytoscape;

            var event = document.createEvent("HTMLEvents");
            event.initEvent("load_cytoscape", true, false);
            window.dispatchEvent(event);
        }
    );
}

    </script>
</head>

<body>
<div id="{{ uuid }}"></div>
<!-- When only #uuid div is placed on this page,
the height of output-box on ipynb will be 0px.
One line below will prevent that. -->
<div id="dummy" style="width:{{ widget_width }}px;height:{{ widget_height }}px"></div>
</body>

</html>
